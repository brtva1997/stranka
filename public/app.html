<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Přehled splátek</title>

  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet" />

  <script>
    if (sessionStorage.getItem('catClicked') !== 'true') {
      window.location.href = 'index.html';
    }
    window.addEventListener('beforeunload', () => {
      sessionStorage.removeItem('catClicked');
    });
  </script>
</head>

<body>
  <div id="hearts-container"></div>

  <div id="app">
    <h2>💸 Přehled splátek</h2>

    <div id="summary">
      <div>Zaplaceno: <strong id="paidAmount">…</strong> Kč</div>
      <div>Zbývá zaplatit: <strong id="unpaidAmount">…</strong> Kč</div>
    </div>

    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Datum</th>
          <th>Stav</th>
          <th>Částka</th>
        </tr>
      </thead>
      <tbody>
        <tr class="paid" data-amount="1000"><td>1</td><td>2024-01-01</td><td></td><td>1000</td></tr>
        <tr class="paid" data-amount="1500"><td>2</td><td>2024-02-01</td><td></td><td>1500</td></tr>
        <tr class="unpaid nearest-highlight" data-amount="1200"><td>3</td><td>2024-03-01</td><td></td><td>1200</td></tr>
        <tr class="unpaid" data-amount="1800"><td>4</td><td>2024-04-01</td><td></td><td>1800</td></tr>
      </tbody>
    </table>
  </div>

  <script>
    const paid = [...document.querySelectorAll('tr.paid')];
    const unpaid = [...document.querySelectorAll('tr.unpaid')];

    const paidSum = paid.reduce((sum, row) => sum + Number(row.dataset.amount), 0);
    const unpaidSum = unpaid.reduce((sum, row) => sum + Number(row.dataset.amount), 0);

    document.getElementById('paidAmount').textContent = paidSum.toLocaleString();
    document.getElementById('unpaidAmount').textContent = unpaidSum.toLocaleString();

    // 💖 generátor srdíček
    const hearts = document.getElementById('hearts-container');
    setInterval(() => {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.style.left = Math.random() * 100 + '%';
      heart.style.fontSize = Math.random() * 20 + 10 + 'px';
      heart.style.animationDuration = 6 + Math.random() * 4 + 's';
      heart.textContent = '❤';
      hearts.appendChild(heart);
      setTimeout(() => hearts.removeChild(heart), 10000);
    }, 400);
  </script>
</body>
</html>
